{"version":3,"file":"spiral-b3451183.js","sources":["../../src/spiral/app.jsx"],"sourcesContent":["import { Index, batch, createMemo, createSignal, onMount } from 'solid-js';\nimport { Show, render } from 'solid-js/web';\n\nimport * as perfmon from 'perf-monitor';\n\nimport './style.css';\n\nfunction Spiral () {\n\tconst COUNT = 500;\n\tconst LOOPS = 6;\n\n\tconst [x, setX] = createSignal(0);\n\tconst [y, setY] = createSignal(0);\n\tconst [big, setBig] = createSignal(false);\n\tconst [counter, setCounter] = createSignal(0);\n\n\tlet stopped = false;\n\tlet moved = { x: 0, y: 0, timeout: false };\n\n\tconst cursors = createMemo(() => {\n\t\tconst max = COUNT + Math.round(Math.sin((counter() / 90) * 2 * Math.PI) * COUNT * 0.5);\n\t\tconst next = [];\n\n\t\tfor (let i = max; i--;) {\n\t\t\tlet f = (i / max) * LOOPS;\n\t\t\tlet theta = f * 2 * Math.PI;\n\t\t\tlet m = 20 + i * 2;\n\t\t\tlet hue = (f * 255 + counter() * 10) % 255;\n\n\t\t\tnext[i] = {\n\t\t\t\tcolor: `hsl(${hue}, 100%, 50%)`,\n\t\t\t\tx: (x() + Math.sin(theta) * m) | 0,\n\t\t\t\ty: (y() + Math.cos(theta) * m) | 0,\n\t\t\t};\n\t\t}\n\n\t\treturn next;\n\t});\n\n\tconst handlePointerMove = (ev) => {\n\t\tmoved.x = ev.x;\n\t\tmoved.y = ev.y;\n\n\t\tif (!moved.timeout) {\n\t\t\tmoved.timeout = true;\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tbatch(() => {\n\t\t\t\t\tmoved.timeout = false;\n\t\t\t\t\tsetX(moved.x);\n\t\t\t\t\tsetY(moved.y);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t};\n\n\tconst handlePointerDown = () => {\n\t\tsetBig(true);\n\t};\n\n\tconst handlePointerUp = () => {\n\t\tsetBig(false);\n\t};\n\n\tconst increment = () => {\n\t\tif (stopped) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetCounter(counter() + 1);\n\t\trequestAnimationFrame(increment);\n\t};\n\n\tonMount(() => {\n\t\twindow.addEventListener('pointermove', handlePointerMove);\n\t\twindow.addEventListener('pointerdown', handlePointerDown);\n\t\twindow.addEventListener('pointerup', handlePointerUp);\n\n\t\trequestAnimationFrame(increment);\n\n\t\treturn () => {\n\t\t\twindow.removeEventListener('pointermove', handlePointerMove);\n\t\t\twindow.removeEventListener('pointerdown', handlePointerDown);\n\t\t\twindow.removeEventListener('pointerup', handlePointerUp);\n\n\t\t\tstopped = true;\n\t\t};\n\t});\n\n\treturn (\n\t\t<div class='main'>\n\t\t\t<Cursor label x={x()} y={y()} big={big()} />\n\n\t\t\t<Index each={cursors()}>\n\t\t\t\t{(cursor) => (\n\t\t\t\t\t<Cursor\n\t\t\t\t\t\tcolor={cursor().color}\n\t\t\t\t\t\tx={cursor().x}\n\t\t\t\t\t\ty={cursor().y}\n\t\t\t\t\t\tbig={big()}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</Index>\n\t\t</div>\n\t);\n}\n\nfunction Cursor (props) {\n\treturn (\n\t\t<div\n\t\t\tclassList={{ cursor: true, big: props.big, label: props.label }}\n\t\t\tstyle={{\n\t\t\t\t'border-color': props.color,\n\t\t\t\t'transform': `translate(${props.x}px, ${props.y}px) scale(${props.big ? 2 : 1})`,\n\t\t\t}}\n\t\t>\n\t\t\t<Show when={props.label}>\n\t\t\t\t<span class='label'>\n\t\t\t\t\t{props.x} {props.y}\n\t\t\t\t</span>\n\t\t\t</Show>\n\t\t</div>\n\t);\n}\n\nif (!(/[&?]perfmon=(false|off|0)\\b/).test(location.search)) {\n\tperfmon.startFPSMonitor();\n\tperfmon.startMemMonitor();\n}\n\nrender(() => <Spiral />, document.getElementById('root'));\n"],"names":["Spiral","x","setX","createSignal","y","setY","big","setBig","counter","setCounter","stopped","moved","timeout","cursors","createMemo","max","Math","round","sin","PI","next","i","f","theta","m","hue","color","cos","handlePointerMove","ev","requestAnimationFrame","batch","handlePointerDown","handlePointerUp","increment","onMount","window","addEventListener","removeEventListener","_el$","_tmpl$","_$insert","_$createComponent","Cursor","label","Index","each","children","cursor","props","_el$2","_tmpl$3","Show","when","_el$3","_tmpl$2","_el$4","firstChild","_$effect","_p$","_v$","_v$2","_v$3","_v$4","classList","toggle","style","setProperty","removeProperty","undefined","test","location","search","perfmon","render","document","getElementById"],"mappings":"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"}