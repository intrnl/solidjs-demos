{"version":3,"file":"1kpoints-61e8d397.js","sources":["../../src/1kpoints/viridis.js","../../src/1kpoints/app.jsx"],"sourcesContent":["function colors (specifier) {\n\tvar n = specifier.length / 6 | 0, colors = new Array(n), i = 0;\n\twhile (i < n) {\n\t\tcolors[i] = '#' + specifier.slice(i * 6, ++i * 6);\n\t}\n\treturn colors;\n}\n\nfunction ramp (range) {\n\tlet n = range.length;\n\treturn (t) => range[Math.max(0, Math.min(n - 1, Math.floor(t * n)))];\n}\n\nexport let interpolateViridis = ramp(\n\tcolors(\n\t\t'44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725',\n\t),\n);\n","import { Index, createEffect, createSignal, onCleanup } from 'solid-js';\nimport { render } from 'solid-js/web';\n\nimport './style.css';\n\nimport * as perfmon from 'perf-monitor';\nimport { interpolateViridis } from './viridis.js';\n\nconst Layout = {\n\tPHYLLOTAXIS: 0,\n\tGRID: 1,\n\tWAVE: 2,\n\tSPIRAL: 3,\n};\n\nconst LAYOUT_ORDER = [\n\tLayout.PHYLLOTAXIS,\n\tLayout.SPIRAL,\n\tLayout.PHYLLOTAXIS,\n\tLayout.GRID,\n\tLayout.WAVE,\n];\n\nconst theta = Math.PI * (3 - Math.sqrt(5));\n\nfunction App () {\n\tconst [count, setCount] = createSignal(1000);\n\n\tconst params = new URLSearchParams(location.search);\n\n\tif (params.has('count')) {\n\t\tconst next = parseInt(params.get('count'));\n\n\t\tif (!Number.isNaN(next) && next >= 10 && next <= 10000) {\n\t\t\tsetCount(next);\n\t\t}\n\t}\n\n\tfunction onRangeChange (ev) {\n\t\tsetCount(ev.target.valueAsNumber);\n\t}\n\n\treturn (\n\t\t<div className='app-wrapper'>\n\t\t\t<VizDemo count={count()} />\n\n\t\t\t<div className='controls'>\n\t\t\t\t<span># Points</span>\n\t\t\t\t<input type='range' min={10} max={10000} value={count} onChange={onRangeChange} />\n\t\t\t\t<span>{count}</span>\n\t\t\t</div>\n\n\t\t\t<span className='about'>\n\t\t\t\tSolid.js 1k Points demo, based on the{' '}\n\t\t\t\t<a href='https://dingoeatingfuzz.github.io/glimmer-1k/' target='_blank'>Glimmer demo by Michael Lange</a>\n\t\t\t</span>\n\t\t</div>\n\t);\n}\n\nfunction VizDemo (props) {\n\tconst NUM_STEPS = 60 * 2;\n\n\tlet stopped = false;\n\n\tlet phyllotaxis;\n\tlet spiral;\n\tlet grid;\n\tlet wave;\n\n\tlet step = 0;\n\tlet layout = 0;\n\tlet _count = NaN;\n\n\tconst [points, setPoints] = createSignal([]);\n\n\tconst makePoints = (count) => {\n\t\tconst array = [];\n\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst [px, py] = project(phyllotaxis(i));\n\t\t\tconst [sx, sy] = project(spiral(i));\n\t\t\tconst [gx, gy] = project(grid(i));\n\t\t\tconst [wx, wy] = project(wave(i));\n\n\t\t\tarray.push({\n\t\t\t\tx: 0,\n\t\t\t\ty: 0,\n\t\t\t\tcolor: interpolateViridis(i / count),\n\t\t\t\tpx,\n\t\t\t\tpy,\n\t\t\t\tsx,\n\t\t\t\tsy,\n\t\t\t\tgx,\n\t\t\t\tgy,\n\t\t\t\twx,\n\t\t\t\twy,\n\t\t\t});\n\t\t}\n\n\t\treturn array;\n\t};\n\n\tcreateEffect(() => {\n\t\tif (_count !== props.count) {\n\t\t\t_count = props.count;\n\n\t\t\tphyllotaxis = genPhyllotaxis(_count);\n\t\t\tspiral = genSpiral(_count);\n\t\t\tgrid = genGrid(_count);\n\t\t\twave = genWave(_count);\n\n\t\t\tsetPoints(makePoints(_count));\n\t\t}\n\t});\n\n\tcreateEffect(() => {\n\t\tconst next = () => {\n\t\t\tif (stopped) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tstep = (step + 1) % NUM_STEPS;\n\t\t\tlayout = step === 0 ? (layout + 1) % LAYOUT_ORDER.length : layout;\n\n\t\t\t// Clamp the linear interpolation at 80% for a pause at each finished layout state\n\t\t\tconst pct = Math.min(1, step / (NUM_STEPS * 0.8));\n\n\t\t\tconst currentLayout = LAYOUT_ORDER[layout];\n\t\t\tconst nextLayout = LAYOUT_ORDER[(layout + 1) % LAYOUT_ORDER.length];\n\n\t\t\tconst pxProp = xForLayout(currentLayout);\n\t\t\tconst nxProp = xForLayout(nextLayout);\n\t\t\tconst pyProp = yForLayout(currentLayout);\n\t\t\tconst nyProp = yForLayout(nextLayout);\n\n\t\t\tconst nextPoints = points().map((point) => {\n\t\t\t\tconst next = { ...point };\n\t\t\t\tnext.x = lerp(next, pct, pxProp, nxProp);\n\t\t\t\tnext.y = lerp(next, pct, pyProp, nyProp);\n\n\t\t\t\treturn next;\n\t\t\t});\n\n\t\t\tsetPoints(nextPoints);\n\t\t\trequestAnimationFrame(next);\n\t\t};\n\n\t\trequestAnimationFrame(next);\n\t\tonCleanup(() => (stopped = true));\n\t});\n\n\treturn (\n\t\t<svg className='demo'>\n\t\t\t<Index each={points()}>\n\t\t\t\t{(point) => (\n\t\t\t\t\t<rect\n\t\t\t\t\t\tclass='point'\n\t\t\t\t\t\ttransform={`translate(${Math.floor(point().x)}, ${Math.floor(point().y)})`}\n\t\t\t\t\t\tfill={point().color}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</Index>\n\t\t</svg>\n\t);\n}\n\nif (!(/[&?]perfmon=(false|off|0)\\b/).test(location.search)) {\n\tperfmon.startFPSMonitor();\n\tperfmon.startMemMonitor();\n}\n\nrender(() => <App />, document.getElementById('root'));\n\nfunction xForLayout (layout) {\n\tswitch (layout) {\n\t\tcase Layout.PHYLLOTAXIS:\n\t\t\treturn 'px';\n\t\tcase Layout.GRID:\n\t\t\treturn 'gx';\n\t\tcase Layout.WAVE:\n\t\t\treturn 'wx';\n\t\tcase Layout.SPIRAL:\n\t\t\treturn 'sx';\n\t}\n}\n\nfunction yForLayout (layout) {\n\tswitch (layout) {\n\t\tcase Layout.PHYLLOTAXIS:\n\t\t\treturn 'py';\n\t\tcase Layout.GRID:\n\t\t\treturn 'gy';\n\t\tcase Layout.WAVE:\n\t\t\treturn 'wy';\n\t\tcase Layout.SPIRAL:\n\t\t\treturn 'sy';\n\t}\n}\n\nfunction lerp (obj, percent, startProp, endProp) {\n\tlet px = obj[startProp];\n\treturn px + (obj[endProp] - px) * percent;\n}\n\nfunction genPhyllotaxis (n) {\n\treturn (i) => {\n\t\tlet r = Math.sqrt(i / n);\n\t\tlet th = i * theta;\n\t\treturn [r * Math.cos(th), r * Math.sin(th)];\n\t};\n}\n\nfunction genGrid (n) {\n\tlet rowLength = Math.round(Math.sqrt(n));\n\treturn (i) => [-0.8 + (1.6 / rowLength) * (i % rowLength), -0.8 + (1.6 / rowLength) * Math.floor(i / rowLength)];\n}\n\nfunction genWave (n) {\n\tlet xScale = 2 / (n - 1);\n\treturn (i) => {\n\t\tlet x = -1 + i * xScale;\n\t\treturn [x, Math.sin(x * Math.PI * 3) * 0.3];\n\t};\n}\n\nfunction genSpiral (n) {\n\treturn (i) => {\n\t\tlet t = Math.sqrt(i / (n - 1)),\n\t\t\tphi = t * Math.PI * 10;\n\t\treturn [t * Math.cos(phi), t * Math.sin(phi)];\n\t};\n}\n\nfunction scale (magnitude, vector) {\n\treturn vector.map((p) => p * magnitude);\n}\n\nfunction translate (translation, vector) {\n\treturn vector.map((p, i) => p + translation[i]);\n}\n\nfunction project (vector) {\n\tconst wh = window.innerHeight / 2;\n\tconst ww = window.innerWidth / 2;\n\treturn translate([ww, wh], scale(Math.min(wh, ww), vector));\n}\n"],"names":["interpolateViridis","range","n","length","t","Math","max","min","floor","ramp","specifier","colors","Array","i","slice","Layout","PHYLLOTAXIS","GRID","WAVE","SPIRAL","LAYOUT_ORDER","theta","PI","sqrt","App","count","setCount","createSignal","params","URLSearchParams","location","search","has","next","parseInt","get","Number","isNaN","onRangeChange","ev","target","valueAsNumber","_el$","_tmpl$","_el$2","firstChild","_el$4","nextSibling","_el$5","_$insert","_$createComponent","VizDemo","addEventListener","value","props","phyllotaxis","spiral","grid","wave","stopped","step","layout","_count","NaN","points","setPoints","createEffect","r","th","cos","sin","phi","genSpiral","rowLength","round","genGrid","xScale","x","genWave","array","px","py","project","sx","sy","gx","gy","wx","wy","push","y","color","makePoints","pct","currentLayout","nextLayout","pxProp","xForLayout","nxProp","pyProp","yForLayout","nyProp","nextPoints","map","point","lerp","requestAnimationFrame","onCleanup","_el$6","_tmpl$2","Index","each","children","_el$7","_tmpl$3","_$effect","_p$","_v$","_v$2","_$setAttribute","undefined","obj","percent","startProp","endProp","vector","wh","window","innerHeight","ww","innerWidth","translation","p","translate","magnitude","scale","test","perfmon","render","document","getElementById"],"mappings":"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"}