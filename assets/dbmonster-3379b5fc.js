import{a as e,r as t,c as a,i as r,I as s,d as l,h as n,t as o}from"./web-43728d99.js";import{s as i,a as u,i as m,b as p,e as d}from"./perf-monitor-5bf4888d.js";var c=c||function(){var e,t,a=0;function r(e){e||(e={});var t,a,r=15*Math.random();return e.elapsed=r,e.formatElapsed=(t=r)>60?(a=(t%60).toFixed(2).split("."),Math.floor(t/60)+":"+a[0].lpad("0",2)+"."+a[1]):parseFloat(t).toFixed(2),e.elapsedClassName=function(e){var t="Query elapsed";return t+(e>=10?" warn_long":e>=1?" warn":" short")}(r),e.query="SELECT blah FROM something",e.waiting=Math.random()<.5,Math.random()<.2&&(e.query="<IDLE> in transaction"),Math.random()<.1&&(e.query="vacuum"),e}function s(e){if(!e)return{query:"***",formatElapsed:"",elapsedClassName:""};e.formatElapsed="",e.elapsedClassName="",e.query="",e.elapsed=null,e.waiting=null}function l(e,t,a){var l=Math.floor(10*Math.random()+1);if(e||(e={}),e.lastMutationId=a,e.nbQueries=l,e.lastSample||(e.lastSample={}),e.lastSample.topFiveQueries||(e.lastSample.topFiveQueries=[]),t){if(!e.lastSample.queries){e.lastSample.queries=[];for(var n=0;n<12;n++)e.lastSample.queries[n]=s()}for(var o in e.lastSample.queries){var i=e.lastSample.queries[o];o<=l?r(i):s(i)}}else{e.lastSample.queries=[];for(o=0;o<12;o++)if(o<l){i=r(s());e.lastSample.queries.push(i)}else e.lastSample.queries.push(s())}for(var u=0;u<5;u++){var m=e.lastSample.queries[u];e.lastSample.topFiveQueries[u]=m}return e.lastSample.nbQueries=l,e.lastSample.countClassName=function(e){var t="label";return t+(e>=20?" label-important":e>=10?" label-warning":" label-success")}(l),e}(t=String.prototype).lpad||(t.lpad=function(e,t){return e.repeat((t-this.length)/e.length).concat(this)});var n=.5;var o=document.querySelector("body"),i=o.firstChild,u=document.createElement("div");u.style.cssText="display: flex";var m=document.createElement("input"),p=document.createElement("label");return p.innerHTML="mutations : "+(100*n).toFixed(0)+"%",p.id="ratioval",m.setAttribute("type","range"),m.style.cssText="margin-bottom: 10px; margin-top: 5px",m.addEventListener("change",(function(e){c.mutations(e.target.value/100),document.querySelector("#ratioval").innerHTML="mutations : "+(100*c.mutations()).toFixed(0)+"%"})),u.appendChild(p),u.appendChild(m),o.insertBefore(u,i),{generateData:function(t){var r=e;if(!t){e=[];for(var s=1;s<=c.rows;s++)e.push({dbname:"cluster"+s,query:"",formatElapsed:"",elapsedClassName:""}),e.push({dbname:"cluster"+s+" replica",query:"",formatElapsed:"",elapsedClassName:""})}if(!e){e=[];for(s=1;s<=c.rows;s++)e.push({dbname:"cluster"+s}),e.push({dbname:"cluster"+s+" replica"});r=e}for(var s in e){var n=e[s];!t&&r&&r[s]&&(n.lastSample=r[s].lastSample),!n.lastSample||Math.random()<c.mutations()?(a+=1,t||(n.lastSample=null),l(n,t,a)):e[s]=r[s]}return{toArray:function(){return e}}},rows:50,timeout:0,mutations:function(e){return e?n=e:n}}}();window.ENV=c;const f=o('<table class="table table-striped latest-data"><tbody>'),v=o('<tr><td class="dbname"></td><td class="query-count"><span>'),h=o('<td><div class="popover left"><div class="popover-content"></div><div class="arrow">');function b(e){return(()=>{const t=f(),o=t.firstChild;return r(o,a(s,{get each(){return e.dbs},children:e=>(()=>{const t=v(),o=t.firstChild,i=o.nextSibling.firstChild;return r(o,(()=>e().dbname)),r(i,(()=>e().lastSample.nbQueries)),r(t,a(s,{get each(){return e().lastSample.topFiveQueries},children:e=>(()=>{const t=h(),a=t.firstChild,s=a.firstChild;return r(t,(()=>e().formatElapsed),a),r(s,(()=>e().query)),l((()=>n(t,e().elapsedClassName))),t})()}),null),l((()=>n(i,e().lastSample.countClassName))),t})()})),t})()}if(/[&?]perfmon=(false|off|0)\b/.test(location.search)){const y=document.getElementById("root"),[g,q]=e([]);function S(){const e=ENV.generateData().toArray();q(e),setTimeout(S,ENV.timeout)}S(),t((()=>a(b,{get dbs(){return g()}})),y)}else{i(),u(),m("view update");const E=document.getElementById("root"),[C,w]=e([]);function S(){const e=ENV.generateData().toArray();p("view update"),w(e),d("view update"),setTimeout(S,ENV.timeout)}S(),t((()=>a(b,{get dbs(){return C()}})),E)}
//# sourceMappingURL=dbmonster-3379b5fc.js.map
