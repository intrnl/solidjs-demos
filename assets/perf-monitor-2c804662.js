var h=100,y=function(){function e(t,n,i,r){this.min=t,this.max=n,this.mean=i,this.last=r}return e}(),f=function(){function e(t){this.samples=[],this.maxSamples=t,this._i=-1}return e.prototype.addSample=function(t){this._i=(this._i+1)%this.maxSamples,this.samples[this._i]=t},e.prototype.each=function(t){for(var n=this.samples,i=0;i<n.length;i++)t(n[(this._i+1+i)%n.length],i)},e.prototype.calc=function(){var t=this.samples;if(t.length===0)return new y(0,0,0,0);for(var n=t[(this._i+1)%t.length],i=n,r=0,o=0;o<t.length;o++){var a=t[(this._i+1+o)%t.length];a<n&&(n=a),a>i&&(i=a),r+=a}var l=t[this._i],d=r/t.length;return new y(n,i,d,l)},e}(),p=[],T=-1;function C(e){p.push(e),T===-1&&requestAnimationFrame(function(t){T=-1;var n=p;p=[];for(var i=0;i<n.length;i++)n[i]()})}var M=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),c=30,_=h,H=function(){function e(t){var n=this;this._sync=function(){n.sync(),n._dirty=!1},this.name=t,this.element=document.createElement("div"),this.element.style.cssText="padding: 2px;background-color: #020;font-family: monospace;font-size: 12px;color: #0f0",this._dirty=!1,this.invalidate()}return e.prototype.invalidate=function(){this._dirty||(this._dirty=!0,C(this._sync))},e.prototype.sync=function(){throw new Error("sync method not implemented")},e}(),s;(function(e){e[e.HideMin=1]="HideMin",e[e.HideMax=2]="HideMax",e[e.HideMean=4]="HideMean",e[e.HideLast=8]="HideLast",e[e.HideGraph=16]="HideGraph",e[e.RoundValues=32]="RoundValues"})(s||(s={}));var v=function(e){M(t,e);function t(n,i,r,o){var a=e.call(this,n)||this;a.flags=i,a.unitName=r,a.samples=o;var l=document.createElement("div");l.style.cssText="text-align: center",l.textContent=a.name;var d=document.createElement("div");return i&s.HideMin?a.minText=null:(a.minText=document.createElement("div"),d.appendChild(a.minText)),i&s.HideMax?a.maxText=null:(a.maxText=document.createElement("div"),d.appendChild(a.maxText)),i&s.HideMean?a.meanText=null:(a.meanText=document.createElement("div"),d.appendChild(a.meanText)),i&s.HideLast?a.lastText=null:(a.lastText=document.createElement("div"),d.appendChild(a.lastText)),a.element.appendChild(l),a.element.appendChild(d),i&s.HideGraph?(a.canvas=null,a.ctx=null):(a.canvas=document.createElement("canvas"),a.canvas.style.cssText="display: block; padding: 0; margin: 0",a.canvas.width=_,a.canvas.height=c,a.ctx=a.canvas.getContext("2d"),a.element.appendChild(a.canvas)),a}return t.prototype.sync=function(){var n=this,i=this.samples.calc(),r=c/(i.max*1.2),o,a,l,d;this.flags&s.RoundValues?(o=Math.round(i.min).toString(),a=Math.round(i.max).toString(),l=Math.round(i.mean).toString(),d=Math.round(i.last).toString()):(o=i.min.toFixed(2),a=i.max.toFixed(2),l=i.mean.toFixed(2),d=i.last.toFixed(2)),this.minText!==null&&(this.minText.textContent="min:  "+o+this.unitName),this.maxText!==null&&(this.maxText.textContent="max:  "+a+this.unitName),this.meanText!==null&&(this.meanText.textContent="mean: "+l+this.unitName),this.lastText!==null&&(this.lastText.textContent="last: "+d+this.unitName),this.ctx!==null&&(this.ctx.fillStyle="#010",this.ctx.fillRect(0,0,_,c),this.ctx.fillStyle="#0f0",this.samples.each(function(S,w){n.ctx.fillRect(w,c,1,-(S*r))}))},t}(H);(function(e){M(t,e);function t(n,i){var r=e.call(this,n)||this;return r.counter=i,r.text=document.createElement("div"),r.element.appendChild(r.text),r}return t.prototype.sync=function(){this.text.textContent=this.name+": "+this.counter.value},t})(H);var m=null;function x(){m||(m=document.createElement("div"),m.style.cssText="position: fixed;opacity: 0.9;right: 0;bottom: 0",document.body.appendChild(m))}function P(e){e===void 0&&(e=s.HideMin|s.HideMax|s.HideMean|s.RoundValues),x();var t=new f(h),n=new v("FPS",e,"",t);m.appendChild(n.element);var i=2/121,r=0,o=60;function a(l){r>0&&(o+=i*(1e3/(l-r)-o)),r=l,t.addSample(o),n.invalidate(),requestAnimationFrame(a)}requestAnimationFrame(a)}function R(e){if(e===void 0&&(e=s.HideMin|s.HideMean),x(),performance.memory===void 0)return;var t=new f(h),n=new v("Memory",e,"MB",t);m.appendChild(n.element);function i(){t.addSample(Math.round(performance.memory.usedJSHeapSize/(1024*1024))),n.invalidate(),setTimeout(i,30)}i()}var E=function(){function e(t,n,i){this.data=new f(h),this.widget=new v(t,i,n,this.data),this.startTime=-1}return e}(),u={};function A(e,t){t===void 0&&(t=0),x();var n=u[e];n===void 0&&(u[e]=n=new E(e,"ms",t),m.appendChild(n.widget.element))}function N(e){var t=u[e];t!==void 0&&(t.startTime=performance.now())}function G(e){var t=performance.now(),n=u[e];n!==void 0&&n.startTime!==-1&&(n.data.addSample(t-n.startTime),n.widget.invalidate())}export{R as a,N as b,G as e,A as i,P as s};
